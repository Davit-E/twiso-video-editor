(this["webpackJsonptwiso-video-editor"]=this["webpackJsonptwiso-video-editor"]||[]).push([[0],{2:function(e,t,n){e.exports={Navigation:"Navigation_Navigation__1vpyv",BackFileInfoContainer:"Navigation_BackFileInfoContainer__zDoEb",BackArrow:"Navigation_BackArrow__2EuDm",FileInfoContainer:"Navigation_FileInfoContainer__13jQZ",FileName:"Navigation_FileName__t8V0Z",Creater:"Navigation_Creater__2m7n3",ControlsContainer:"Navigation_ControlsContainer__3cZve",DesignControl:"Navigation_DesignControl__18GfM",AddTextContainer:"Navigation_AddTextContainer__2D7x7",AddImageContainer:"Navigation_AddImageContainer__Ay_Rj",AddShapeContainer:"Navigation_AddShapeContainer__1Vor-",HoverContent:"Navigation_HoverContent__2EgVD",HoverTriangle:"Navigation_HoverTriangle__267f9",HoverText:"Navigation_HoverText__24Vce",DownloadUserInfoContainer:"Navigation_DownloadUserInfoContainer___5XCM",DownloadButton:"Navigation_DownloadButton__2FuTK",User:"Navigation_User__3SWWK",UserInitials:"Navigation_UserInitials__2BS83",ShapeDropdown:"Navigation_ShapeDropdown__2HDOH",ImageDropdown:"Navigation_ImageDropdown__3bu_4",DownloadDropdown:"Navigation_DownloadDropdown__2IsbQ",UploadVideo:"Navigation_UploadVideo__3uZ5a"}},25:function(e,t,n){},26:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(19),o=n.n(i),c=(n(25),n(3)),s=(n(26),n(7)),d=n.n(s),l=n(9),u=n(8),j=n.n(u),p=n(2),b=n.n(p),v=n.p+"static/media/backArrow.0fa2b863.svg",f=n.p+"static/media/addText.3a1cc6fe.svg",_=n.p+"static/media/addImage.5167341a.svg",g=n.p+"static/media/addShape.efc88c00.svg",h=n.p+"static/media/subtitles.7c1e1dd4.svg",m=n(0),O=function(e){var t=e.setVideoForUpload,n=e.isUploading,r=Object(a.useRef)(null);return Object(m.jsxs)("header",{className:b.a.Navigation,children:[Object(m.jsxs)("div",{className:b.a.BackFileInfoContainer,children:[Object(m.jsx)("img",{className:b.a.BackArrow,src:v,alt:"back"}),Object(m.jsxs)("div",{className:b.a.FileInfoContainer,children:[Object(m.jsx)("p",{className:b.a.FileName,children:"Untitled"}),Object(m.jsx)("p",{className:b.a.Creater,children:"Dmitry"})]}),Object(m.jsx)("button",{className:b.a.UploadVideo,onClick:function(){return r.current.click()},children:n?"Loading...":" Upload video"}),Object(m.jsx)("input",{ref:r,type:"file",accept:"video/mp4",style:{display:"none"},onChange:function(){t(r.current.files[0])}})]}),Object(m.jsxs)("div",{className:b.a.ControlsContainer,children:[Object(m.jsxs)("div",{className:b.a.AddTextContainer,id:"addText",children:[Object(m.jsx)("img",{src:f,alt:"add text"}),Object(m.jsxs)("div",{className:b.a.HoverContent,children:[Object(m.jsx)("div",{className:b.a.HoverTriangle}),Object(m.jsx)("p",{className:b.a.HoverText,children:"Add text"})]})]}),Object(m.jsx)("div",{className:b.a.DesignControl,children:Object(m.jsxs)("div",{className:b.a.AddImageContainer,id:"addImage",children:[Object(m.jsx)("img",{src:_,alt:"add image"}),Object(m.jsxs)("div",{className:b.a.HoverContent,children:[Object(m.jsx)("div",{className:b.a.HoverTriangle}),Object(m.jsx)("p",{className:b.a.HoverText,children:"Add image"})]})]})}),Object(m.jsx)("div",{className:b.a.DesignControl,children:Object(m.jsxs)("div",{id:"addShape",className:b.a.AddShapeContainer,children:[Object(m.jsx)("img",{src:g,alt:"add shape"}),Object(m.jsxs)("div",{className:b.a.HoverContent,children:[Object(m.jsx)("div",{className:b.a.HoverTriangle}),Object(m.jsx)("p",{className:b.a.HoverText,children:"Add shape"})]})]})}),Object(m.jsx)("div",{className:b.a.DesignControl,children:Object(m.jsxs)("div",{id:"subtitles",className:b.a.AddShapeContainer,children:[Object(m.jsx)("img",{src:h,alt:"subtitles"}),Object(m.jsxs)("div",{className:b.a.HoverContent,children:[Object(m.jsx)("div",{className:b.a.HoverTriangle}),Object(m.jsx)("p",{className:b.a.HoverText,children:"Subtitles"})]})]})})]}),Object(m.jsxs)("div",{className:b.a.DownloadUserInfoContainer,children:[Object(m.jsx)("button",{id:"downloadDesign",className:b.a.DownloadButton,children:"Download"}),Object(m.jsx)("div",{className:b.a.User,children:Object(m.jsx)("p",{className:b.a.UserInitials,children:"DE"})})]})]})},x=n(6),N=n.n(x),C=n.p+"static/media/cut.50fbea68.svg",I=n.p+"static/media/search.01416d75.svg",S=function(e,t,n,a,r,i){"delete"===e?function(e,t,n,a){for(var r=[],i=!1,o=0,c=0,s=0;s<e.length;s++){var d=e[s];!d.deleted&&i?(i=!1,r.push({start:o,end:c})):d.deleted&&!i?(i=!0,o=d.start,c=d.end):d.deleted&&i&&(c=d.end)}i&&r.push({start:o,end:c}),n(a,r),t([].concat(r))}(t,n,a,r):"restore"===e&&function(e,t,n,a){e((function(e){for(var r=[],i=0;i<e.length;i++){var o=e[i];o.start!==a&&r.push(o)}return t(n,r),[].concat(r)}))}(n,a,r,i)},T=function(e,t,n,a,r){var i=null;if(null!==e&&0!==e)for(var o=e;o>=0;o--){if(!t[o].deleted){i=o;break}}if(null===i)for(var c=e;c<t.length;c++){if(!t[c].deleted){i=c;break}}var s=t[i];n(s?s.id:null),S("delete",t,a,r,s.id)},w=n(5),D=n.n(w),k=n.p+"static/media/restoreText.63dbbf27.svg",W=function(e){var t=e.wordsArr,n=e.currentWordId,r=e.searchInput,i=e.wordClickHandler,o=e.inputId,s=e.setInputId,d=e.currentSelection,l=Object(a.useState)(""),u=Object(c.a)(l,2),j=u[0],p=u[1],b=Object(a.useRef)(null),v=function(){for(var e=j.trim().length>0?j:null,n=null,a=0;a<t.length;a++){if(t[a].id===o){n=a;break}}t[n]&&(e&&!t[n].silence?t[n].text=e:e?(t[n].text=e,t[n].silence=!1):t[n].silence=!0),p(""),s(null)},f=!1,_=!0,g=!1,h=!1;return Object(a.useEffect)((function(){if(o){b.current.focus();for(var e=null,n=0;n<t.length;n++){if(t[n].id===o){e=n;break}}t[e]&&!t[e].silence&&p(t[e].text)}}),[o,t]),t.map((function(e){_=!f||!e.deleted;var t=e.id===n&&!d&&!e.deleted,a=!e.silence&&!e.deleted&&r.trim().length>1&&e.text.trim().toLowerCase().includes(r.trim().toLowerCase());!f&&e.deleted&&(f=!0),f&&!e.deleted&&(f=!1),d&&d.start===e.id?g=!0:d&&d.end===e.id?h=!0:h&&(g=!1,h=!1);var c=o&&t,s=c?Object(m.jsx)("input",{ref:b,className:D.a.WordInput,type:"text",value:j,onBlur:v,onChange:function(e){return p(e.target.value)}}):Object(m.jsx)("span",{className:e.silence?D.a.Pause:D.a.Word,children:e.silence?"\u2022\u2022\u2022\u2022 ":e.text+" "}),l=e.deleted?Object(m.jsxs)("span",{className:D.a.Deleted,children:[Object(m.jsx)("span",{className:D.a.DeletedImgContainer,children:Object(m.jsx)("img",{className:D.a.DeletedImg,src:k,alt:"restore text"})}),Object(m.jsx)("span",{className:D.a.DeletedText,children:"[...] "})]}):s,u={width:"auto"};return c&&(u.width=e.silence?"70px":1.5*e.text.length+"ch",u.marginRight="0.4rem"),_?Object(m.jsx)("span",{style:u,id:e.id,className:[D.a.WordContainer,t?D.a.CurrentWord:null,a?D.a.Highlight:null,g?D.a.InSelection:null].join(" "),onClick:function(t){return i(t,e.deleted)},children:l},e.id):null}))},A=function(e){var t=e.words,n=e.currentWordId,r=e.setCurrentWordId,i=e.isPlaying,o=e.playerRef,s=e.setCuts,d=e.currentSelection,l=e.setCurrentSelection,u=e.setPlayerTime,j=Object(a.useState)(""),p=Object(c.a)(j,2),b=p[0],v=p[1],f=Object(a.useState)(null),_=Object(c.a)(f,2),g=_[0],h=_[1],O=Object(a.useCallback)((function(e,t,n,a,i,o){var c="",s="";t.parentNode.id===n.parentNode.id?(t.parentNode.id&&(u(t.parentNode.id),r(t.parentNode.id)),l(null)):a&&i?4===o?(c=t.parentNode.id,s=n.parentNode.id):2===o&&(c=n.parentNode.id,s=t.parentNode.id):a?4===o?(c=t.parentNode.id,s=t.parentNode.parentNode.lastChild.id):2===o&&(c=t.parentNode.parentNode.firstChild.id,s=t.parentNode.id):i&&(4===o?(c=t.parentNode.parentNode.firstChild.parentNode.id,s=n.id):2===o&&(c=n.id,s=t.parentNode.parentNode.lastChild.parentNode.id)),""!==c&&""!==s&&(l({start:c,end:s}),u(c),r(c)),e.removeAllRanges()}),[r,l,u]),x=Object(a.useCallback)((function(e){var t=document.getSelection();if(e.detail<2&&t.anchorNode&&t.focusNode){var n=t.anchorNode.parentNode,a=t.focusNode.parentNode,r="SPAN"===n.tagName,c="SPAN"===a.tagName,s=t.anchorNode.compareDocumentPosition(t.focusNode);!r&&!c||t.isCollapsed||(i&&o.current.pause(),O(t,n,a,r,c,s))}}),[O,i,o]);Object(a.useEffect)((function(){return document.addEventListener("mouseup",x),function(){return document.removeEventListener("mouseup",x)}}),[x]);return Object(m.jsxs)("div",{className:N.a.Transcription,children:[Object(m.jsxs)("div",{className:N.a.TextControls,children:[Object(m.jsxs)("div",{className:N.a.CutContainer,onClick:function(){i&&o.current.pause(),!d&&n?function(e,t,n,a,r){for(var i=null,o=0;o<e.length;o++){var c=e[o];if(c.id===t){c.deleted=!0,i=o;break}}T(i,e,n,a,r)}(t,n,r,s,u):d&&function(e,t,n,a,r,i){for(var o=!1,c=null,s=0;s<e.length;s++){var d=e[s];if(d.id===n.start)o=!0,c=s;else if(d.id===n.end){o=!1,d.deleted=!0;break}o&&(d.deleted=!0)}T(c,e,t,r,i),a(null)}(t,r,d,l,s,u)},children:[Object(m.jsx)("img",{src:C,alt:"cut"}),Object(m.jsx)("p",{children:"Cut"})]}),Object(m.jsxs)("div",{className:N.a.SearchContainer,children:[Object(m.jsx)("input",{value:b,onChange:function(e){return v(e.target.value)},className:N.a.SearchInput,placeholder:"Search",type:"text"}),Object(m.jsx)("img",{className:N.a.SearchSvg,src:I,alt:"search"})]})]}),Object(m.jsx)("div",{id:"textbox",className:N.a.Text,children:t?Object(m.jsx)(W,{wordsArr:t,currentWordId:n,searchInput:b,wordClickHandler:function(e,n){var a=e.currentTarget.id;i&&o.current.pause(),e.detail>1&&!g&&h(a),n||g?g||function(e,t,n,a,r,i){for(var o=0,c=0;c<e.length;c++)if(e[c].id===t){o=c;break}for(var s=o;s<e.length;s++){var d=e[s];if(!d.deleted)break;d.deleted=!1}var l=e[o].start;S("restore",null,r,i,t,l),a(null),n(t)}(t,a,r,l,s,u):(l(null),u(a),r(a))},inputId:g,setInputId:h,currentSelection:d}):null})]})},H=n(20),y=n.n(H).a.create({baseURL:"".concat("http://165.227.198.78","/api/v1")}),U=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(null),o=Object(c.a)(i,2),s=o[0],u=o[1],j=Object(a.useState)(null),p=Object(c.a)(j,2),b=p[0],v=p[1],f=Object(a.useRef)(null),_=Object(a.useCallback)((function(e){return new Promise((function(t,n){y.post("/upload",e,{headers:{Accept:"application/json","Content-Type":"multipart/form-data"}}).then((function(e){t(e)})).catch((function(e){n(e)}))}))}),[]);return{isUploading:n,uploadVideo:Object(a.useCallback)(function(){var e=Object(l.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.prev=1,e.next=4,_(t);case 4:n=e.sent,console.log(n.data),u(n.data.duration),f.current=n.data.text_breakup,v(n.data.full_text),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("Error Uploading Video",e.t0);case 14:return e.prev=14,r(!1),e.abrupt("return");case 18:case"end":return e.stop()}}),e,null,[[1,11,14,18]])})));return function(t){return e.apply(this,arguments)}}(),[_]),words:f.current,duration:s,fullText:b}},E=function(){var e=Object(l.a)(d.a.mark((function e(t,n,a){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("video",t),e.prev=2,e.next=5,a(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log(e.t0);case 10:return e.prev=10,n(null),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(t,n,a){return e.apply(this,arguments)}}(),V=function(){var e=U(),t=e.isUploading,n=e.uploadVideo,r=e.words,i=e.duration,o=(e.fullText,Object(a.useState)(null)),s=Object(c.a)(o,2),d=s[0],l=s[1],u=Object(a.useState)(null),p=Object(c.a)(u,2),b=p[0],v=p[1],f=Object(a.useState)(null),_=Object(c.a)(f,2),g=_[0],h=_[1],x=Object(a.useState)(!1),N=Object(c.a)(x,2),C=N[0],I=N[1],S=Object(a.useState)(null),T=Object(c.a)(S,2),w=T[0],D=T[1],k=Object(a.useState)(null),W=Object(c.a)(k,2),H=W[0],y=W[1],V=Object(a.useState)([]),P=Object(c.a)(V,2),F=P[0],R=P[1],B=Object(a.useState)(null),L=Object(c.a)(B,2),M=L[0],Z=L[1],z=Object(a.useRef)(null);Object(a.useEffect)((function(){g&&(E(g,h,n),z.current.src=URL.createObjectURL(g))}),[g,n]),Object(a.useEffect)((function(){r&&v(r[0].id)}),[r]);Object(a.useEffect)((function(){console.log(M)}),[M]);var J=Object(a.useCallback)((function(e){e+=.05,F.length>0&&null!==M&&F[M]&&e>=+F[M].start&&e<=+F[M].end&&(z.current.currentTime=F[M].end,F[M+1]&&Z(M+1))}),[F,M]),q=Object(a.useCallback)((function(e){e+=.05;for(var t=0;t<r.length;t++){var n=r[t];if(+n.start<=e&&+n.end>=e&&!n.deleted){v(n.id);break}}}),[r]);return Object(a.useEffect)((function(){null!==H&&q(H)}),[H,q]),Object(a.useEffect)((function(){null!==H&&J(H)}),[H,J]),Object(m.jsxs)("div",{className:j.a.VideoEditor,children:[Object(m.jsx)(O,{setVideoForUpload:h,isUploading:t}),Object(m.jsxs)("main",{className:j.a.Main,children:[Object(m.jsx)(A,{className:j.a.VideoEditor,words:r,currentWordId:b,setCurrentWordId:v,isPlaying:C,playerRef:z,setCuts:R,currentSelection:d,setCurrentSelection:l,setPlayerTime:function(e,t){t=F;for(var n="0",a=0;a<r.length;a++){var i=r[a];if(e===i.id){n=i.end,z.current.currentTime=i.start;break}}for(var o=0,c=0;c<t.length;c++){+n>+t[c].end&&o++}Z(o)}}),Object(m.jsx)("div",{className:j.a.Player,children:Object(m.jsx)("video",{style:{display:i?"block":"none"},className:j.a.Video,ref:z,controls:!0,onPlay:function(e){document.getSelection().removeAllRanges(),d&&l(null),I(!0);var t=setInterval((function(){y(z.current.currentTime)}),10);D(t)},onPause:function(e){I(!1),clearInterval(w)},onEnded:function(e){F.length>0&&Z(0),y(0)}})})]})]})},P=Object(a.createContext)(null),F={},R=function(e,t){switch(t.type){case"":default:return e}},B=function(){var e=Object(a.useReducer)(R,F),t=Object(c.a)(e,2);return[t[0],t[1]]},L=function(){var e=B(),t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(P.Provider,{value:{editorState:n,editorDispatch:a},children:Object(m.jsx)(V,{})})})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,48)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),i(e),o(e)}))};o.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(L,{})}),document.getElementById("root")),M()},5:function(e,t,n){e.exports={WordContainer:"Words_WordContainer__2MxYw",Word:"Words_Word__3b2m1",Pause:"Words_Pause__33kzp",Deleted:"Words_Deleted__3CMYk",DeletedText:"Words_DeletedText__1n8km",WordInput:"Words_WordInput__3lLIb",CurrentWord:"Words_CurrentWord__3w6qS",Highlight:"Words_Highlight__cba72",DeletedImgContainer:"Words_DeletedImgContainer__2Mj9-",DeletedImg:"Words_DeletedImg__2JxpA",InSelection:"Words_InSelection__33LHP"}},6:function(e,t,n){e.exports={Transcription:"Transcription_Transcription__13teg",TextControls:"Transcription_TextControls__1U4fb",CutContainer:"Transcription_CutContainer__3Pv4S",SearchContainer:"Transcription_SearchContainer__3q-zR",SearchInput:"Transcription_SearchInput__3ojca",Text:"Transcription_Text__3pvrU"}},8:function(e,t,n){e.exports={VideoEditor:"VideoEditor_VideoEditor__1aRjl",Main:"VideoEditor_Main__RsHdg",Player:"VideoEditor_Player__2Wd3k",Video:"VideoEditor_Video__1I_Ob"}}},[[47,1,2]]]);
//# sourceMappingURL=main.5a02caf6.chunk.js.map