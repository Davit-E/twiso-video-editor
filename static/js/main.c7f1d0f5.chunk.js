(this["webpackJsonptwiso-video-editor"]=this["webpackJsonptwiso-video-editor"]||[]).push([[0],{2:function(e,t,a){e.exports={Navigation:"Navigation_Navigation__1vpyv",BackFileInfoContainer:"Navigation_BackFileInfoContainer__zDoEb",BackArrow:"Navigation_BackArrow__2EuDm",FileInfoContainer:"Navigation_FileInfoContainer__13jQZ",FileName:"Navigation_FileName__t8V0Z",Creater:"Navigation_Creater__2m7n3",ControlsContainer:"Navigation_ControlsContainer__3cZve",DesignControl:"Navigation_DesignControl__18GfM",AddTextContainer:"Navigation_AddTextContainer__2D7x7",AddImageContainer:"Navigation_AddImageContainer__Ay_Rj",AddShapeContainer:"Navigation_AddShapeContainer__1Vor-",HoverContent:"Navigation_HoverContent__2EgVD",HoverTriangle:"Navigation_HoverTriangle__267f9",HoverText:"Navigation_HoverText__24Vce",DownloadUserInfoContainer:"Navigation_DownloadUserInfoContainer___5XCM",DownloadButton:"Navigation_DownloadButton__2FuTK",User:"Navigation_User__3SWWK",UserInitials:"Navigation_UserInitials__2BS83",ShapeDropdown:"Navigation_ShapeDropdown__2HDOH",ImageDropdown:"Navigation_ImageDropdown__3bu_4",DownloadDropdown:"Navigation_DownloadDropdown__2IsbQ",UploadVideo:"Navigation_UploadVideo__3uZ5a"}},25:function(e,t,a){},26:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(19),o=a.n(i),c=(a(25),a(26),a(3)),s=a(7),d=a.n(s),l=a(9),u=a(8),j=a.n(u),p=a(2),b=a.n(p),v=a.p+"static/media/backArrow.0fa2b863.svg",_=a.p+"static/media/addText.3a1cc6fe.svg",f=a.p+"static/media/addImage.5167341a.svg",m=a.p+"static/media/addShape.efc88c00.svg",g=a.p+"static/media/subtitles.7c1e1dd4.svg",h=a(0),x=function(e){var t=e.setVideoForUpload,a=e.isUploading,r=Object(n.useRef)(null);return Object(h.jsxs)("header",{className:b.a.Navigation,children:[Object(h.jsxs)("div",{className:b.a.BackFileInfoContainer,children:[Object(h.jsx)("img",{className:b.a.BackArrow,src:v,alt:"back"}),Object(h.jsxs)("div",{className:b.a.FileInfoContainer,children:[Object(h.jsx)("p",{className:b.a.FileName,children:"Untitled"}),Object(h.jsx)("p",{className:b.a.Creater,children:"Dmitry"})]}),Object(h.jsx)("button",{className:b.a.UploadVideo,onClick:function(){return r.current.click()},children:a?"Loading...":" Upload video"}),Object(h.jsx)("input",{ref:r,type:"file",accept:"video/mp4",style:{display:"none"},onChange:function(){t(r.current.files[0])}})]}),Object(h.jsxs)("div",{className:b.a.ControlsContainer,children:[Object(h.jsxs)("div",{className:b.a.AddTextContainer,id:"addText",children:[Object(h.jsx)("img",{src:_,alt:"add text"}),Object(h.jsxs)("div",{className:b.a.HoverContent,children:[Object(h.jsx)("div",{className:b.a.HoverTriangle}),Object(h.jsx)("p",{className:b.a.HoverText,children:"Add text"})]})]}),Object(h.jsx)("div",{className:b.a.DesignControl,children:Object(h.jsxs)("div",{className:b.a.AddImageContainer,id:"addImage",children:[Object(h.jsx)("img",{src:f,alt:"add image"}),Object(h.jsxs)("div",{className:b.a.HoverContent,children:[Object(h.jsx)("div",{className:b.a.HoverTriangle}),Object(h.jsx)("p",{className:b.a.HoverText,children:"Add image"})]})]})}),Object(h.jsx)("div",{className:b.a.DesignControl,children:Object(h.jsxs)("div",{id:"addShape",className:b.a.AddShapeContainer,children:[Object(h.jsx)("img",{src:m,alt:"add shape"}),Object(h.jsxs)("div",{className:b.a.HoverContent,children:[Object(h.jsx)("div",{className:b.a.HoverTriangle}),Object(h.jsx)("p",{className:b.a.HoverText,children:"Add shape"})]})]})}),Object(h.jsx)("div",{className:b.a.DesignControl,children:Object(h.jsxs)("div",{id:"subtitles",className:b.a.AddShapeContainer,children:[Object(h.jsx)("img",{src:g,alt:"subtitles"}),Object(h.jsxs)("div",{className:b.a.HoverContent,children:[Object(h.jsx)("div",{className:b.a.HoverTriangle}),Object(h.jsx)("p",{className:b.a.HoverText,children:"Subtitles"})]})]})})]}),Object(h.jsxs)("div",{className:b.a.DownloadUserInfoContainer,children:[Object(h.jsx)("button",{id:"downloadDesign",className:b.a.DownloadButton,children:"Download"}),Object(h.jsx)("div",{className:b.a.User,children:Object(h.jsx)("p",{className:b.a.UserInitials,children:"DE"})})]})]})},N=a(6),O=a.n(N),C=a.p+"static/media/cut.50fbea68.svg",I=a.p+"static/media/search.01416d75.svg",S=function(e,t,a,n){var r=null;if(null!==e&&0!==e)for(var i=e;i>=0;i--){if(!t[i].deleted){r=i;break}}if(null===r)for(var o=e;o<t.length;o++){if(!t[o].deleted){r=o;break}}var c=t[r];n(c?c.id:null),a(c?c.id:null)},T=a(5),w=a.n(T),D=a.p+"static/media/restoreText.63dbbf27.svg",k=function(e){var t=e.wordsArr,a=e.currentWordId,r=e.searchInput,i=e.wordClickHandler,o=e.inputId,s=e.setInputId,d=e.currentSelection,l=Object(n.useState)(""),u=Object(c.a)(l,2),j=u[0],p=u[1],b=Object(n.useRef)(null),v=function(){for(var e=j.trim().length>0?j:null,a=null,n=0;n<t.length;n++){if(t[n].id===o){a=n;break}}t[a]&&(e&&!t[a].silence?t[a].text=e:e?(t[a].text=e,t[a].silence=!1):t[a].silence=!0),p(""),s(null)},_=!1,f=!0,m=!1,g=!1;return Object(n.useEffect)((function(){if(o){b.current.focus();for(var e=null,a=0;a<t.length;a++){if(t[a].id===o){e=a;break}}t[e]&&!t[e].silence&&p(t[e].text)}}),[o,t]),t.map((function(e){f=!_||!e.deleted;var t=e.id===a&&!d&&!e.deleted,n=!e.silence&&!e.deleted&&r.trim().length>1&&e.text.trim().toLowerCase().includes(r.trim().toLowerCase());!_&&e.deleted&&(_=!0),_&&!e.deleted&&(_=!1),d&&d.start===e.id?m=!0:d&&d.end===e.id?g=!0:g&&(m=!1,g=!1);var c=o&&t,s=c?Object(h.jsx)("input",{ref:b,className:w.a.WordInput,type:"text",value:j,onBlur:v,onChange:function(e){return p(e.target.value)}}):Object(h.jsx)("span",{className:e.silence?w.a.Pause:w.a.Word,children:e.silence?"\u2022\u2022\u2022\u2022 ":e.text+" "}),l=e.deleted?Object(h.jsxs)("span",{className:w.a.Deleted,children:[Object(h.jsx)("span",{className:w.a.DeletedImgContainer,children:Object(h.jsx)("img",{className:w.a.DeletedImg,src:D,alt:"restore text"})}),Object(h.jsx)("span",{className:w.a.DeletedText,children:"[...] "})]}):s,u={width:"auto"};return c&&(u.width=e.silence?"70px":1.5*e.text.length+"ch",u.marginRight="0.4rem"),f?Object(h.jsx)("span",{style:u,id:e.id,className:[w.a.WordContainer,t?w.a.CurrentWord:null,n?w.a.Highlight:null,m?w.a.InSelection:null].join(" "),onClick:function(t){return i(t,e.deleted)},children:l},e.id):null}))},W=function(e){var t=e.words,a=e.currentWordId,r=e.setCurrentWordId,i=e.isPlaying,o=e.playerRef,s=(e.setCuts,e.currentSelection),d=e.setCurrentSelection,l=e.setPlayerTime,u=Object(n.useState)(""),j=Object(c.a)(u,2),p=j[0],b=j[1],v=Object(n.useState)(null),_=Object(c.a)(v,2),f=_[0],m=_[1],g=Object(n.useCallback)((function(e,t,a,n,i,o){var c="",s="";t.parentNode.id===a.parentNode.id?(t.parentNode.id&&(r(t.parentNode.id),l(t.parentNode.id)),d(null)):n&&i?4===o?(c=t.parentNode.id,s=a.parentNode.id):2===o&&(c=a.parentNode.id,s=t.parentNode.id):n?4===o?(c=t.parentNode.id,s=t.parentNode.parentNode.lastChild.id):2===o&&(c=t.parentNode.parentNode.firstChild.id,s=t.parentNode.id):i&&(4===o?(c=t.parentNode.parentNode.firstChild.parentNode.id,s=a.id):2===o&&(c=a.id,s=t.parentNode.parentNode.lastChild.parentNode.id)),""!==c&&""!==s&&(d({start:c,end:s}),r(c),l(c)),e.removeAllRanges()}),[r,d,l]),x=Object(n.useCallback)((function(e){var t=document.getSelection();if(e.detail<2&&t.anchorNode&&t.focusNode){var a=t.anchorNode.parentNode,n=t.focusNode.parentNode,r="SPAN"===a.tagName,c="SPAN"===n.tagName,s=t.anchorNode.compareDocumentPosition(t.focusNode);!r&&!c||t.isCollapsed||(i&&o.current.pause(),g(t,a,n,r,c,s))}}),[g,i,o]);Object(n.useEffect)((function(){return document.addEventListener("mouseup",x),function(){return document.removeEventListener("mouseup",x)}}),[x]);return Object(h.jsxs)("div",{className:O.a.Transcription,children:[Object(h.jsxs)("div",{className:O.a.TextControls,children:[Object(h.jsxs)("div",{className:O.a.CutContainer,onClick:function(){i&&o.current.pause(),!s&&a?function(e,t,a,n,r){for(var i=null,o=0;o<e.length;o++){var c=e[o];if(c.id===t){c.deleted=!0,i=o;break}}S(i,e,a,r)}(t,a,r,0,l):s&&function(e,t,a,n,r,i){for(var o=!1,c=null,s=0;s<e.length;s++){var d=e[s];if(d.id===a.start)o=!0,c=s;else if(d.id===a.end){o=!1,d.deleted=!0;break}o&&(d.deleted=!0)}S(c,e,t,i),n(null)}(t,r,s,d,0,l)},children:[Object(h.jsx)("img",{src:C,alt:"cut"}),Object(h.jsx)("p",{children:"Cut"})]}),Object(h.jsxs)("div",{className:O.a.SearchContainer,children:[Object(h.jsx)("input",{value:p,onChange:function(e){return b(e.target.value)},className:O.a.SearchInput,placeholder:"Search",type:"text"}),Object(h.jsx)("img",{className:O.a.SearchSvg,src:I,alt:"search"})]})]}),Object(h.jsx)("div",{id:"textbox",className:O.a.Text,children:t?Object(h.jsx)(k,{wordsArr:t,currentWordId:a,searchInput:p,wordClickHandler:function(e,a){var n=e.currentTarget.id;i&&o.current.pause(),e.detail>1&&!f&&m(n),a||f?f||function(e,t,a,n,r,i){for(var o=0,c=0;c<e.length;c++)if(e[c].id===t){o=c;break}for(var s=o;s<e.length;s++){var d=e[s];if(!d.deleted)break;d.deleted=!1}n(null),a(t),i(t)}(t,n,r,d,0,l):(d(null),r(n),l(n))},inputId:f,setInputId:m,currentSelection:s}):null})]})},A=a(20),H=a.n(A).a.create({baseURL:"".concat("http://165.227.198.78","/api/v1")}),U=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],r=t[1],i=Object(n.useState)(null),o=Object(c.a)(i,2),s=o[0],u=o[1],j=Object(n.useState)(null),p=Object(c.a)(j,2),b=p[0],v=p[1],_=Object(n.useRef)(null),f=Object(n.useCallback)((function(e){return new Promise((function(t,a){H.post("/upload",e,{headers:{Accept:"application/json","Content-Type":"multipart/form-data"}}).then((function(e){t(e)})).catch((function(e){a(e)}))}))}),[]);return{isUploading:a,uploadVideo:Object(n.useCallback)(function(){var e=Object(l.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.prev=1,e.next=4,f(t);case 4:a=e.sent,console.log(a.data),u(a.data.duration),_.current=a.data.text_breakup,v(a.data.full_text),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("Error Uploading Video",e.t0);case 14:return e.prev=14,r(!1),e.abrupt("return");case 18:case"end":return e.stop()}}),e,null,[[1,11,14,18]])})));return function(t){return e.apply(this,arguments)}}(),[f]),words:_.current,duration:s,fullText:b}},y=function(){var e=Object(l.a)(d.a.mark((function e(t,a,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("video",t),e.prev=2,e.next=5,n(r);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log(e.t0);case 10:return e.prev=10,a(null),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[2,7,10,13]])})));return function(t,a,n){return e.apply(this,arguments)}}(),V=function(){var e=U(),t=e.isUploading,a=e.uploadVideo,r=e.words,i=e.duration,o=(e.fullText,Object(n.useState)(null)),s=Object(c.a)(o,2),d=s[0],l=s[1],u=Object(n.useState)(null),p=Object(c.a)(u,2),b=p[0],v=p[1],_=Object(n.useState)(0),f=Object(c.a)(_,2),m=(f[0],f[1],Object(n.useState)(null)),g=Object(c.a)(m,2),N=g[0],O=g[1],C=Object(n.useState)(!1),I=Object(c.a)(C,2),S=I[0],T=I[1],w=Object(n.useState)(null),D=Object(c.a)(w,2),k=D[0],A=D[1],H=Object(n.useState)(null),V=Object(c.a)(H,2),E=V[0],P=V[1],F=Object(n.useState)([]),R=Object(c.a)(F,2),B=(R[0],R[1]),L=Object(n.useRef)(null);Object(n.useEffect)((function(){N&&(y(N,O,a),L.current.src=URL.createObjectURL(N))}),[N,a]),Object(n.useEffect)((function(){r&&v(r[0].id)}),[r]);var M=Object(n.useCallback)((function(e){for(var t=0;t<r.length;t++){var a=r[t];if(a.start<=e&&a.end>=e)if(a.deleted&&r[t-1]&&!r[t-1].deleted)for(var n=t;n<r.length;n++){var i=r[n];if(i.deleted&&r[n+1]&&!r[n+1].deleted){L.current.currentTime="".concat(+i.end);break}r[n+1]||(L.current.currentTime="".concat(+i.end))}else if(!a.deleted){v(a.id);break}}}),[]);return Object(n.useEffect)((function(){r&&M(E)}),[r,E,M]),Object(h.jsxs)("div",{className:j.a.VideoEditor,children:[Object(h.jsx)(x,{setVideoForUpload:O,isUploading:t}),Object(h.jsxs)("main",{className:j.a.Main,children:[Object(h.jsx)(W,{className:j.a.VideoEditor,words:r,currentWordId:b,setCurrentWordId:v,isPlaying:S,playerRef:L,setCuts:B,currentSelection:d,setCurrentSelection:l,setPlayerTime:function(e){for(var t=0;t<r.length;t++){var a=r[t];if(e===a.id){L.current.currentTime=a.start;break}}}}),Object(h.jsx)("div",{className:j.a.Player,children:Object(h.jsx)("video",{style:{display:i?"block":"none"},className:j.a.Video,ref:L,controls:!0,onPlay:function(e){document.getSelection().removeAllRanges(),d&&l(null),T(!0);var t=setInterval((function(){P(L.current.currentTime)}),100);A(t)},onPause:function(e){T(!1),clearInterval(k)}})})]})]})},E=function(){return Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(V,{})})},P=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,48)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;a(e),n(e),r(e),i(e),o(e)}))};o.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(E,{})}),document.getElementById("root")),P()},5:function(e,t,a){e.exports={WordContainer:"Words_WordContainer__2MxYw",Word:"Words_Word__3b2m1",Pause:"Words_Pause__33kzp",Deleted:"Words_Deleted__3CMYk",DeletedText:"Words_DeletedText__1n8km",WordInput:"Words_WordInput__3lLIb",CurrentWord:"Words_CurrentWord__3w6qS",Highlight:"Words_Highlight__cba72",DeletedImgContainer:"Words_DeletedImgContainer__2Mj9-",DeletedImg:"Words_DeletedImg__2JxpA",InSelection:"Words_InSelection__33LHP"}},6:function(e,t,a){e.exports={Transcription:"Transcription_Transcription__13teg",TextControls:"Transcription_TextControls__1U4fb",CutContainer:"Transcription_CutContainer__3Pv4S",SearchContainer:"Transcription_SearchContainer__3q-zR",SearchInput:"Transcription_SearchInput__3ojca",Text:"Transcription_Text__3pvrU"}},8:function(e,t,a){e.exports={VideoEditor:"VideoEditor_VideoEditor__1aRjl",Main:"VideoEditor_Main__RsHdg",Player:"VideoEditor_Player__2Wd3k",Video:"VideoEditor_Video__1I_Ob"}}},[[47,1,2]]]);
//# sourceMappingURL=main.c7f1d0f5.chunk.js.map